<div class="cve-report">
    <div class="cve-header">
        <div class="cve-id-badge">
            <i class="fas fa-shield-alt"></i>
            <span class="cve-id">{{ cve.cve_no|default('N/A') }}</span>
        </div>
        <div class="cve-status">
            <span class="status-badge status-{{ cve.exploit_code_maturity|lower|replace(' ', '-')|default('unknown') }}">
                {{ cve.exploit_code_maturity|default('Active') }}
            </span>
        </div>
    </div>

    <div class="cve-title-section">
        <h2>{{ cve.cve_title|default('Untitled Vulnerability') }}</h2>
    </div>

    <div class="cve-metadata">
        <div class="metadata-item">
            <i class="fas fa-calendar-plus"></i>
            <div class="metadata-content">
                <span class="metadata-label">Valid From</span>
                <span class="metadata-value">{{ cve.valid_from[:10] if cve.valid_from else 'N/A' }}</span>
            </div>
        </div>
        <div class="metadata-item">
            <i class="fas fa-calendar-check"></i>
            <div class="metadata-content">
                <span class="metadata-label">Last Modified</span>
                <span class="metadata-value">{{ cve.source_last_modified_date[:10] if cve.source_last_modified_date else 'N/A' }}</span>
            </div>
        </div>
        <div class="metadata-item">
            <i class="fas fa-tag"></i>
            <div class="metadata-content">
                <span class="metadata-label">Keywords</span>
                <span class="metadata-value">{{ cve.keywords|default('N/A') }}</span>
            </div>
        </div>
        <div class="metadata-item">
            <i class="fas fa-shield-virus"></i>
            <div class="metadata-content">
                <span class="metadata-label">CISA KEV</span>
                <span class="metadata-value">{{ cve.cisa_key|default('No') }}</span>
            </div>
        </div>
    </div>

    <div class="cve-section">
        <div class="section-header">
            <i class="fas fa-file-alt"></i>
            <h3>Description</h3>
        </div>
        <div class="section-content">
            <p>{{ cve.description|default('No description available.') }}</p>
            {% if cve.t_description %}
            <div class="technical-description">
                <h4>Technical Details:</h4>
                <p>{{ cve.t_description }}</p>
            </div>
            {% endif %}
        </div>
    </div>

    {% if cve.input_vector %}
    <div class="cve-section">
        <div class="section-header">
            <i class="fas fa-exclamation-triangle"></i>
            <h3>CVSS Vector</h3>
        </div>
        <div class="section-content">
            <div class="cvss-vector">
                <i class="fas fa-link"></i>
                <code>{{ cve.input_vector }}</code>
            </div>

            <div class="cvss-details">
                <div class="detail-group">
                    <h4><i class="fas fa-chart-bar"></i> Exploit Metrics</h4>
                    <div class="detail-grid">
                        <div class="detail-item">
                            <span class="detail-label">Exploit Maturity</span>
                            <span class="detail-value badge-pill">{{ cve.exploit_code_maturity|default('Not Defined') }}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Remediation Level</span>
                            <span class="detail-value badge-pill">{{ cve.remediation_level|default('Not Defined') }}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Report Confidence</span>
                            <span class="detail-value badge-pill">{{ cve.report_confidence|default('Not Defined') }}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% endif %}

    <div class="cve-section">
        <div class="section-header">
            <i class="fas fa-layer-group"></i>
            <h3>Classifications</h3>
        </div>
        <div class="section-content">
            <div class="detail-grid">
                {% if cve.classifications_location %}
                <div class="detail-item">
                    <span class="detail-label">Location</span>
                    <span class="detail-value">{{ cve.classifications_location }}</span>
                </div>
                {% endif %}
                {% if cve.classifications_attack_type %}
                <div class="detail-item">
                    <span class="detail-label">Attack Type</span>
                    <span class="detail-value">{{ cve.classifications_attack_type }}</span>
                </div>
                {% endif %}
                {% if cve.classifications_impact %}
                <div class="detail-item">
                    <span class="detail-label">Impact</span>
                    <span class="detail-value">{{ cve.classifications_impact }}</span>
                </div>
                {% endif %}
                {% if cve.classifications_exploit %}
                <div class="detail-item">
                    <span class="detail-label">Exploit Status</span>
                    <span class="detail-value">{{ cve.classifications_exploit }}</span>
                </div>
                {% endif %}
                {% if cve.classifications_additional %}
                <div class="detail-item">
                    <span class="detail-label">Additional Info</span>
                    <span class="detail-value">{{ cve.classifications_additional }}</span>
                </div>
                {% endif %}
            </div>
        </div>
    </div>

    {% if cve.affected_products %}
    <div class="cve-section">
        <div class="section-header">
            <i class="fas fa-box-open"></i>
            <h3>Affected Products</h3>
        </div>
        <div class="section-content">
            <p>{{ cve.affected_products }}</p>
        </div>
    </div>
    {% endif %}

    {% if cve.solution %}
    <div class="cve-section">
        <div class="section-header">
            <i class="fas fa-wrench"></i>
            <h3>Solution</h3>
        </div>
        <div class="section-content">
            <p>{{ cve.solution }}</p>
        </div>
    </div>
    {% endif %}

    {% if cve.manual_notes %}
    <div class="cve-section">
        <div class="section-header">
            <i class="fas fa-sticky-note"></i>
            <h3>Manual Notes</h3>
        </div>
        <div class="section-content">
            <p>{{ cve.manual_notes }}</p>
        </div>
    </div>
    {% endif %}

    {% if cve.additional_text %}
    <div class="cve-section">
        <div class="section-header">
            <i class="fas fa-info-circle"></i>
            <h3>Additional Information</h3>
        </div>
        <div class="section-content">
            <p>{{ cve.additional_text }}</p>
        </div>
    </div>
    {% endif %}
</div>
